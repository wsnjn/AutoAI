# AutoAI 项目启动指南

## 🚀 快速启动

### 1. 启动所有服务
```bash
# 使用批处理脚本（推荐）
.\start-services.bat

# 或手动启动
cd backend && npm install && node index.js
cd frontend && npm install && npm run dev
```

### 2. 访问地址
- **前端应用**: http://localhost:5173
- **后端API**: http://localhost:3000
- **登录页面**: http://localhost:5173/auth

### 3. 默认用户
- **用户名**: wslop
- **密码**: 345345
- **角色**: admin

## 📋 系统功能

### 🔐 用户认证系统
- ✅ 用户注册和登录
- ✅ 密码加密存储（bcrypt）
- ✅ 路由守卫保护
- ✅ 用户状态管理
- ✅ 退出登录功能

### 🏠 新首页系统
- ✅ 动态渐变背景
- ✅ WSLOP Logo设计
- ✅ 可折叠侧边栏
- ✅ 响应式顶部导航
- ✅ 搜索框功能
- ✅ 用户信息显示
- ✅ 二级路由系统

### 📊 仪表盘系统
- ✅ 用户个性化数据展示
- ✅ 实时项目统计信息
- ✅ 动态文件数量统计
- ✅ 团队成员数量统计
- ✅ AI对话数量统计
- ✅ 最近项目列表
- ✅ 快速操作功能

### 📁 项目管理系统
- ✅ 项目创建和加入
- ✅ 文件树显示（已修复显示不一致问题）
- ✅ 文件上传和管理
- ✅ 文件夹创建
- ✅ 项目日志记录
- ✅ 嵌套文件夹和文件完整显示
- ✅ 项目删除功能
- ✅ 项目类型分类（HTML、Vue、Android、小程序、React）

### 🤖 AI助手系统
- ✅ DeepSeek AI集成
- ✅ 代码修改建议
- ✅ 文件操作功能
- ✅ 对话历史记录
- ✅ 操作日志记录
- ✅ 智能文件路径查找
- ✅ 项目结构分析
- ✅ 批量文件操作
- ✅ 文件修改检测（支持"把xxx改成xxx"表达方式）
- ✅ 先删除再创建策略
- ✅ 智能意图识别
- ✅ 用户专属AI记忆系统
- ✅ 长期对话历史

### 🎮 3D模型与语音交互
- ✅ Three.js 3D模型集成
- ✅ 全局3D助手（右下角固定位置）
- ✅ 语音识别功能
- ✅ 语音合成朗读
- ✅ 预设对话系统
- ✅ AI聊天集成

### 🖼️ 实时预览系统
- ✅ HTML文件实时预览
- ✅ Vue文件实时预览
- ✅ 代码编辑器集成
- ✅ 双模式切换（预览/编辑）
- ✅ 实时保存功能
- ✅ 文件内容同步
- ✅ 响应式布局优化

## 🗄️ 数据库结构

### 核心表
- `users` - 用户表
- `projects` - 项目表
- `project_members` - 项目成员表
- `project_logs` - 项目日志表
- `ai_conversations` - AI对话表
- `code_modifications` - 代码修改表
- `chathistory` - 用户专属聊天历史表

### 动态表
- `{project_name}` - 项目文件表
- `{project_name}__{folder_name}` - 文件夹专用表

## 🔧 技术栈

### 前端
- **框架**: Vue 3
- **路由**: Vue Router 4
- **样式**: 纯CSS（无第三方UI库）
- **构建**: Vite
- **3D渲染**: Three.js
- **语音**: Web Speech API

### 后端
- **框架**: Node.js + Express
- **数据库**: MySQL
- **ORM**: mysql2/promise
- **加密**: bcryptjs
- **AI**: DeepSeek API

## 📁 项目结构

```
AutoAI/
├── frontend/                 # 前端应用
│   ├── src/
│   │   ├── views/           # 页面组件
│   │   ├── components/      # 通用组件
│   │   └── router/          # 路由配置
│   └── package.json
├── backend/                  # 后端应用
│   ├── services/            # 业务服务
│   ├── config/              # 配置文件
│   └── package.json
└── 文档/                     # 项目文档
```

## 🎯 主要功能页面

### 1. 登录注册页面 (`/auth`)
- 现代化设计界面
- 表单验证
- 错误提示
- 响应式布局

### 2. 主页面 (`/`)
- 用户个性化仪表盘
- 实时项目统计信息
- 最近项目列表
- 快速操作功能
- 动态数据加载

### 3. 项目管理 (`/projects`)
- 项目列表（按类型分类）
- 创建新项目
- 项目详情
- 项目删除

### 4. 文件管理 (`/files`)
- AI聊天界面
- 用户专属对话历史
- 语音交互集成
- 智能滚动

### 5. AI助手 (`/ai-assistant`)
- 3D模型展示
- 模型切换
- 模型信息

### 6. 设置页面 (`/settings`)
- 系统状态监控
- AI服务测试
- 健康检查

## 🔍 故障排除

### 常见问题

1. **PowerShell命令语法错误**
   - 问题：`&&` 不是有效语句分隔符
   - 解决：使用 `;` 或分别执行命令

2. **Vue 3兼容性问题**
   - 问题：`this.$set is not a function`
   - 解决：直接赋值 `this.item.expanded = true`

3. **服务启动顺序问题**
   - 问题：前端连接后端失败
   - 解决：使用批处理脚本控制启动顺序

4. **数据库JSON解析错误**
   - 问题：无效JSON数据
   - 解决：使用CAST函数强制转换

5. **用户密码验证失败**
   - 问题：密码未加密存储
   - 解决：使用bcrypt正确加密

6. **文件树显示不一致**
   - 问题：左侧文件树和右侧文件管理器显示不同
   - 解决：修改API从所有相关数据表获取数据

7. **预览页面高度问题**
   - 问题：预览内容没有占满中间组件高度
   - 解决：使用绝对定位布局，避免双重高度计算

8. **文件更新API错误**
   - 问题：保存代码时出现400错误
   - 解决：添加缺失的getFolderTables方法

9. **AI文件修改功能问题**
   - 问题：AI无法识别"把xxx改成xxx"表达方式，总是创建新文件
   - 解决：修复正则表达式匹配、API参数格式、数据库参数格式

10. **3D模型加载问题**
    - 问题：3D模型无法显示
    - 解决：检查模型文件路径和Three.js库加载

11. **语音交互问题**
    - 问题：语音识别不工作
    - 解决：确保浏览器支持Web Speech API，使用HTTPS或localhost

12. **用户绑定问题**
    - 问题：chathistory表用户绑定错误
    - 解决：修复前端用户ID获取逻辑

### 启动检查清单

- [ ] 数据库服务运行正常
- [ ] 后端服务启动成功 (端口3000)
- [ ] 前端服务启动成功 (端口5173)
- [ ] 用户表创建完成
- [ ] 默认用户数据正确
- [ ] 路由配置正确
- [ ] API接口测试通过
- [ ] 3D模型文件存在
- [ ] chathistory表创建完成

## 📞 技术支持

如遇到问题，请参考：
1. `问题解决记录.md` - 详细的问题解决过程
2. `项目开发文档.md` - 完整的开发文档
3. `AI_FEATURES.md` - AI功能详细说明
4. 控制台错误信息
5. 网络请求状态

## 🎉 项目特色

- **现代化UI设计**: 动态渐变背景、毛玻璃效果
- **响应式布局**: 适配各种屏幕尺寸
- **模块化架构**: 清晰的代码组织结构
- **安全认证**: 完整的用户认证系统
- **AI集成**: 智能代码助手功能
- **云开发模式**: 数据库驱动的文件管理
- **实时预览**: HTML和Vue文件实时预览和代码编辑
- **智能文件操作**: AI辅助的文件管理和操作
- **三栏布局**: 文件树 | 预览/编辑器 | AI助手
- **高度自适应**: 组件高度完全填充可用空间
- **3D交互**: Three.js 3D模型和语音交互
- **用户专属记忆**: 每个用户独立的AI对话历史

## 📈 最新更新 (2025-10-11)

### ✅ 新增功能
- **3D模型集成**: Three.js 3D模型加载和显示，全局3D助手
- **语音交互系统**: 双击3D模型启动语音识别，支持语音对话和AI回答朗读
- **用户专属AI记忆**: chathistory数据表，每个用户独立的AI对话历史
- **项目类型系统**: 支持HTML、Vue、Android、小程序、React等5种项目类型
- **智能文件生成**: 根据项目类型自动生成基础文件结构
- **文件树重构**: 文件夹表映射，支持无限层级嵌套
- **项目删除功能**: 完整的项目删除和数据清理
- **成员统计优化**: 正确统计项目成员，避免重复计算
- **Vue文件预览**: 支持Vue单文件组件(.vue)的实时预览
- **Vue 3 CDN集成**: 自动加载Vue 3 CDN进行组件渲染
- **SFC解析**: 自动解析Vue单文件组件的template、script、style部分
- **实时预览系统**: HTML文件实时预览功能
- **代码编辑器**: 集成代码编辑器，支持实时保存
- **双模式切换**: 预览模式和代码编辑模式无缝切换
- **AI功能增强**: 智能文件路径查找、项目结构分析
- **布局优化**: 三栏布局、响应式设计、高度自适应
- **AI文件修改**: 支持"把xxx改成xxx"表达方式的文件修改

### 🔧 问题修复
- **用户绑定修复**: 修复chathistory表用户绑定问题，确保使用正确的用户ID
- **文件树显示**: 修复文件树不显示所有文件夹的问题
- **项目类型配置**: 修复项目类型选择和基础文件生成
- **AI记忆系统**: 修复AI长期记忆功能，实现用户专属对话历史
- **3D模型路径**: 修复3D模型加载路径问题
- **语音交互**: 修复语音识别和AI回答集成
- **Vue预览支持**: 添加Vue文件预览功能
- **路径重复问题**: 修复AI创建文件时路径重复的问题
- **语法错误修复**: 修复projectService.js的语法错误
- **预览页面高度**: 修复预览内容高度显示问题
- **文件更新API**: 修复文件保存时的400错误
- **数据库字段**: 修复AI相关表的字段映射问题
- **布局冲突**: 解决flex布局和绝对定位的冲突
- **AI修改检测**: 修复AI无法识别文件修改请求的问题
- **API参数格式**: 修复DeepSeek API调用参数格式错误
- **数据库参数**: 修复createFile方法参数格式不匹配问题

### 📊 技术改进
- **Three.js集成**: 3D模型加载、动画控制、交互处理
- **Web Speech API**: 语音识别和语音合成技术
- **用户数据隔离**: 多用户环境下的数据安全隔离
- **动态表管理**: 文件夹表映射和层级管理
- **项目类型配置**: 集中化的项目类型配置系统
- **Vue组件包装**: 将Vue组件包装在HTML中实现预览效果
- **调试日志系统**: 添加详细的路径解析调试信息
- **项目文件清理**: 删除所有测试文件和临时文件
- **绝对定位布局**: 解决复杂的高度布局问题
- **错误处理**: 增强错误处理和日志记录
- **性能优化**: 优化文件操作和数据库查询
- **正则表达式优化**: 支持无空格输入格式的文件修改检测
- **先删除再创建策略**: 确保文件修改操作的正确性

---

**WSLOP AutoAI Platform** - 让开发更智能，让协作更高效！
